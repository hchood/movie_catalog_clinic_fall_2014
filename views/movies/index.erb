<h3>All the Movies</h3>

<form action='/movies' method='get'>
  <input type='search' name='query'>
  <input type='submit' value='Search'>
</form>

<div>
  <% if @page_no > 1 %>
    <% if !params[:query] %>
      <a href="<%= "/movies?page=#{@page_no - 1}&order=#{@order_param}" %>">Previous</a>
    <% else %>
      <a href="<%= "/movies?page=#{@page_no - 1}&order=#{@order_param}&query=#{params[:query]}" %>">Previous</a>
    <% end %>
  <% end %>

  <% if @page_no < @last_page %>
    <% if !params[:query] %>
      <a href="<%= "/movies?page=#{@page_no + 1}&order=#{@order_param}" %>">Next</a>
    <% else %>
      <a href="<%= "/movies?page=#{@page_no + 1}&order=#{@order_param}&query=#{params[:query]}" %>">Next</a>
    <% end %>
  <% end %>
</div>

<table>
  <thead>
    <tr>
      <th>Title</th>
      <th><a href="/movies?order=year">Year</a></th>
      <th><a href="/movies?order=rating">Rating</a></th>
      <th><a href="/movies?order=genre">Genre</a></th>
      <th><a href="/movies?order=studio">Studio</a></th>
    </tr>
  </thead>

  <tbody>

    <% @movies.each do |movie| %>
      <tr>
        <td><a href="/movies/<%= movie['id'] %>"><%= movie['title'] %></a></td>
        <td><%= movie['year'] %></td>
        <td><%= movie['rating'] %></td>
        <td><%= movie['genre'] %></td>
        <td><%= movie['studio'] %></td>
      </tr>
    <% end %>

  </tbody>
</table>
